#include "doctest.h"
#include "mat.hpp"
using namespace ariel;

#include <string>
#include <algorithm>
using namespace std;

/**
 * Returns the input string without the whitespace characters: space, newline and tab.
 * Requires std=c++2a.
 */
string nospaces(string input) {
	std::erase(input, ' ');
	std::erase(input, '\t');
	std::erase(input, '\n');
	std::erase(input, '\r');
	return input;
}


TEST_CASE("Good input") {
	CHECK(nospaces(mat(9, 7, '@', '-')) == nospaces("@@@@@@@@@\n"
													"@-------@\n"
													"@-@@@@@-@\n"
													"@-@---@-@\n"
													"@-@@@@@-@\n"
													"@-------@\n"
													"@@@@@@@@@"));
	/* Add more test here */

    CHECK(nospaces(mat(9, 7, '@', '@')) == nospaces("@@@@@@@@@\n"
                                                    "@@@@@@@@@\n"
                                                    "@@@@@@@@@\n"
                                                    "@@@@@@@@@\n"
                                                    "@@@@@@@@@\n"
                                                    "@@@@@@@@@\n"
													"@@@@@@@@@"));

    CHECK(nospaces(mat(9, 7, '-', '@')) == nospaces("---------\n"
                                                    "-@@@@@@@-\n"
                                                    "-@-----@-\n"
                                                    "-@-@@@-@-\n"
                                                    "-@-----@-\n"
                                                    "-@@@@@@@-\n"
													"---------"));
    
    CHECK(nospaces(mat(9, 7, '*', ',')) == nospaces("*********\n"
                                                    "*,,,,,,,*\n"
                                                    "*,*****,*\n"
                                                    "*,*,,,*,*\n"
                                                    "*,*****,*\n"
                                                    "*,,,,,,,*\n"
													"*********"));

    CHECK(nospaces(mat(15, 3, '@', '-')) == nospaces("@@@@@@@@@@@@@@@\n"
                                                     "@-------------@\n"
                                                     "@@@@@@@@@@@@@@@"));

    CHECK(nospaces(mat(5, 7, '@', '-')) == nospaces("@@@@@\n"
                                                    "@---@\n"
                                                    "@-@-@\n"
                                                    "@-@-@\n"
                                                    "@-@-@\n"
                                                    "@---@\n"
                                                    "@@@@@"));

    CHECK(nospaces(mat(3, 3, '@', '-')) == nospaces("@@@\n"
                                                    "@-@\n"
                                                    "@@@"));

    CHECK(nospaces(mat(1, 1, '@', '-')) == nospaces("@"));

    CHECK(nospaces(mat(13, 7, '@', '-')) == nospaces("@@@@@@@@@@@@@\n"
                                                     "@-----------@\n"
                                                     "@-@@@@@@@@@-@\n"
                                                     "@-@-------@-@\n"
                                                     "@-@@@@@@@@@-@\n"
                                                     "@-----------@\n"
                                                     "@@@@@@@@@@@@@"));

    CHECK(nospaces(mat(13, 7, '/', '*')) == nospaces("/////////////\n"
                                                     "/***********/\n"
                                                     "/*/////////*/\n"
                                                     "/*/*******/*/\n"
                                                     "/*/////////*/\n"
                                                     "/***********/\n"
                                                     "/////////////"));

    CHECK(nospaces(mat(15, 15, '@', '-')) == nospaces("@@@@@@@@@@@@@@@\n"
                                                      "@-------------@\n"
                                                      "@-@@@@@@@@@@@-@\n"
                                                      "@-@---------@-@\n"
                                                      "@-@-@@@@@@@-@-@\n"
                                                      "@-@-@-----@-@-@\n"
                                                      "@-@-@-@@@-@-@-@\n"
                                                      "@-@-@-@-@-@-@-@\n"
                                                      "@-@-@-@@@-@-@-@\n"
                                                      "@-@-@-----@-@-@\n"
                                                      "@-@-@@@@@@@-@-@\n"
                                                      "@-@---------@-@\n"
                                                      "@-@@@@@@@@@@@-@\n"
                                                      "@-------------@\n"
                                                      "@@@@@@@@@@@@@@@"));

    CHECK(nospaces(mat(31, 15, '@', '-')) == nospaces("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n"
                                                      "@-----------------------------@\n"
                                                      "@-@@@@@@@@@@@@@@@@@@@@@@@@@@@-@\n"
                                                      "@-@-@-----------------------@-@\n"
                                                      "@-@-@-@@@@@@@@@@@@@@@@@@@@@-@-@\n"
                                                      "@-@-@-@-----------------@-@-@-@\n"
                                                      "@-@-@-@-@@@@@@@@@@@@@@@-@-@-@-@\n"
                                                      "@-@-@-@-@-------------@-@-@-@-@\n"
                                                      "@-@-@-@-@@@@@@@@@@@@@@@-@-@-@-@\n"
                                                      "@-@-@-@-----------------@-@-@-@\n"
                                                      "@-@-@-@@@@@@@@@@@@@@@@@@@@@-@-@\n"
                                                      "@-@-@-----------------------@-@\n"
                                                      "@-@@@@@@@@@@@@@@@@@@@@@@@@@@@-@\n"
                                                      "@-----------------------------@\n"
                                                      "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"));

    CHECK(nospaces(mat(99, 25, '@', '-')) == nospaces("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n"
                                                      "@-------------------------------------------------------------------------------------------------@\n"
                                                      "@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@\n"
                                                      "@-@---------------------------------------------------------------------------------------------@-@\n"
                                                      "@-@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@-@\n"
                                                      "@-@-@-----------------------------------------------------------------------------------------@-@-@\n"
                                                      "@-@-@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@-@-@\n"
                                                      "@-@-@-@-------------------------------------------------------------------------------------@-@-@-@\n"
                                                      "@-@-@-@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@-@-@-@\n"
                                                      "@-@-@-@-@---------------------------------------------------------------------------------@-@-@-@-@\n"
                                                      "@-@-@-@-@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@-@-@-@-@\n"
                                                      "@-@-@-@-@-@-----------------------------------------------------------------------------@-@-@-@-@-@\n"
                                                      "@-@-@-@-@-@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@-@-@-@-@-@\n"
                                                      "@-@-@-@-@-@-----------------------------------------------------------------------------@-@-@-@-@-@\n"
                                                      "@-@-@-@-@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@-@-@-@-@\n"
                                                      "@-@-@-@-@---------------------------------------------------------------------------------@-@-@-@-@\n"
                                                      "@-@-@-@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@-@-@-@\n"
                                                      "@-@-@-@-------------------------------------------------------------------------------------@-@-@-@\n"
                                                      "@-@-@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@-@-@\n"
                                                      "@-@-@-----------------------------------------------------------------------------------------@-@-@\n"
                                                      "@-@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@-@\n"
                                                      "@-@---------------------------------------------------------------------------------------------@-@\n"
                                                      "@-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-@\n"
                                                      "@-------------------------------------------------------------------------------------------------@\n"
                                                      "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"));
                                        
}

TEST_CASE("Bad input") {
    CHECK_THROWS(mat(10, 5, '$', '%'));
    /* Add more test here */
    CHECK_THROWS(mat(5, 10, '$', '@'));
    CHECK_THROWS(mat(10, 10, '$', '!'));
    CHECK_THROWS(mat(-1, -3, '@', '#')); //invalid argument (rows,cols >)
}


/* Add more test cases here */

TEST_CASE("Integration") {
    CHECK((nospaces(mat(9, 7, '@', '-') + mat(5, 3, '@', '-'))) == nospaces("@@@@@@@@@\n"
                                                                          "@-------@\n"
                                                                          "@-@@@@@-@\n"
                                                                          "@-@---@-@\n"
                                                                          "@-@@@@@-@\n"
                                                                          "@-------@\n"
                                                                          "@@@@@@@@@@@@@@\n"
                                                                                   "@---@\n"
                                                                                   "@@@@@"));

    CHECK(nospaces(mat(5, 5, '@', '-')) != nospaces("@@@@@\n" // 5x5 wrong char
                                                    "@---@\n"
                                                    "@-@-@\n"
                                                    "@---@\n"
                                                    "@@@@!"));
                                
    CHECK(nospaces(mat(5, 3, '@', '-')) != nospaces("@!#$%"));

    // CHECK(nospaces(mat(5, 5, '@', '-')) <= nospaces("@@@@@@\n" // 5x5 <= 6x6
    //                                                 "@----@\n"
    //                                                 "@-@@-@\n"
    //                                                 "@-@@-@\n"
    //                                                 "@----@\n"
    //                                                 "@@@@@@"));

    // CHECK(nospaces(mat(6, 6, '@', '-')) >= nospaces("@@@@@\n" // 6x6 >= 5x5
    //                                                 "@---@\n"
    //                                                 "@-@-@\n"
    //                                                 "@---@\n"
    //                                                 "@@@@@"));
}